_BASE_: ../base_single_regression.yml
MODEL:
  DEVICE: cuda
  ARCHITECTURE:
    NAME: UmonneModel
    KWARGS:
    - [ hexconv, false]
    - [ num_targets, 2]
    - [ conv_kernel_sizes, [5, 3, 3]]
    - [ conv_channels, [128, 256, 512]]
    - [ last_channels, 256]
    - [ features_encoding_method, positional_encoding ]
    - [ features_position, first]
    - [ dense_layer_units, [128, 128, 128]]
    - [ upsampling_kernel_sizes, [3, 3, 3, 3, 3]]
    - [ normalize_charge, false]
    - [ time_peak_max, true]
    - [ apply_mask, true]
    - [ point_estimation_mode, expected_value]
DATASETS:
  TRAIN:
    EVENTS: /home/asuka/projects/gerumo2/datasets/gamma_sample/splits/train_events.parquet
    TELESCOPES: /home/asuka/projects/gerumo2/datasets/gamma_sample/splits/train_telescopes.parquet
    FOLDER: null
  VALIDATION:
    EVENTS: /home/asuka/projects/gerumo2/datasets/gamma_sample/splits/validation_events.parquet
    TELESCOPES: /home/asuka/projects/gerumo2/datasets/gamma_sample/splits/validation_telescopes.parquet
    FOLDER: null
  TEST:
    EVENTS: null
    TELESCOPES: null
    FOLDER: null
INPUT:
  MAPPER:
    NAME: SimpleSquareImage
  IMAGE_CHANNELS:
    - image
    - peak_time
    - image_mask
  TELESCOPE_FEATURES:
    - pos_x
    - pos_y
SOLVER:
  BASE_LR: 0.0001
  BATCH_SIZE: 64
  LOSS:
    CLASS_NAME: sparse_nd_crossentropy
    CONFIG:
      - [l2_smoothing, 10.0]
  OPTIMIZER:
    CLASS_NAME: SGD
    CONFIG:
      - [momentum, 0.01]
      - [nesterov, true]
  CYCLICAL_LR:
    ENABLE: True
    FACTOR: 2
    MAX_LR: 0.1
    SCALE_FN: fixed_decay